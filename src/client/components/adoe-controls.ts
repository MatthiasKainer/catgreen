import { html } from "lit"
import { pureLit } from "pure-lit"
import { name, showInProgress } from "../storage"
import { buttonStyles, styles } from "./adoe-controls.styles"

pureLit("adoe-controls-name", async ({ label, placeholder }) => {
    return html`
        <adoe-input
            label=${label}
            placeholder=${placeholder}
            value=${name.get().join(",")}
            @change=${(e: CustomEvent) => name.set(e.detail)}
        ><slot></slot></adoe-input>`
}, {
    defaults: { label: "", placeholder: "" }
})
pureLit("adoe-controls-reload", () => {
    return html`
        <adoe-button
            @click=${() => window.postMessage({ type: "reinitialize" })}
        >
        <svg version="1.0" xmlns="http://www.w3.org/2000/svg"
            width="24px" height="24px" viewBox="0 0 1280.000000 1138.000000"
            preserveAspectRatio="xMidYMid meet">
            <metadata>
                Created by potrace 1.15, written by Peter Selinger 2001-2017
            </metadata>
            <g transform="translate(0.000000,1138.000000) scale(0.100000,-0.100000)"
                fill="var(--color-important)" stroke="none">
                <path d="M10550 10764 c0 -463 -69 -1095 -170 -1569 -12 -55 -24 -115 -27
                -132 l-6 -33 -99 93 c-522 487 -932 792 -1426 1061 -505 275 -1112 484 -1657
                571 -55 8 -112 17 -128 20 -88 15 -318 36 -486 45 -418 23 -906 -28 -1356
                -141 -859 -217 -1635 -678 -2315 -1375 -641 -657 -1211 -1582 -1565 -2534 -57
                -154 -115 -327 -115 -344 0 -5 24 13 53 40 71 67 147 124 307 231 372 248 771
                455 1219 635 135 53 134 53 146 -11 26 -145 131 -523 205 -736 85 -242 255
                -618 313 -689 l23 -29 38 154 c66 266 194 635 320 916 355 796 876 1430 1457
                1774 324 192 708 317 1139 371 156 19 582 16 740 -6 775 -108 1461 -414 2163
                -965 106 -83 122 -101 91 -101 -25 0 -211 -55 -391 -116 -408 -136 -755 -298
                -1068 -498 l-80 -51 80 -7 c228 -20 477 -75 760 -170 707 -235 1425 -654 2150
                -1253 153 -127 195 -157 195 -141 0 2 11 46 24 97 69 268 113 574 158 1099 17
                197 17 998 0 1195 -36 422 -63 636 -123 965 -98 535 -280 1118 -509 1630 -28
                63 -53 116 -55 119 -3 2 -5 -49 -5 -115z"/>
                <path d="M1736 5629 c-14 -42 -131 -768 -146 -904 -40 -366 -44 -454 -44 -925
                -1 -550 12 -739 85 -1245 94 -655 276 -1289 542 -1893 l72 -162 2 92 c8 320
                35 718 69 978 29 228 126 764 140 779 3 3 53 -42 112 -100 292 -287 630 -559
                987 -795 675 -445 1421 -732 2190 -843 293 -42 355 -46 705 -46 402 1 554 14
                895 81 1211 236 2259 928 3096 2046 474 634 857 1365 1120 2138 21 63 39 118
                39 123 0 4 -28 -17 -63 -48 -289 -258 -964 -638 -1527 -859 l-115 -45 -11 37
                c-7 20 -26 98 -44 172 -62 265 -144 525 -247 790 -68 172 -195 434 -236 484
                l-24 29 -31 -129 c-144 -587 -406 -1188 -727 -1667 -570 -853 -1248 -1294
                -2170 -1413 -180 -23 -562 -23 -745 0 -773 98 -1486 416 -2200 980 -47 37 -86
                71 -88 75 -1 4 37 18 85 31 129 33 478 150 628 210 238 95 515 235 739 374
                l99 61 -69 7 c-731 73 -1658 474 -2479 1072 -101 73 -510 412 -597 494 -27 26
                -39 32 -42 21z"/>
            </g>
        </svg>
        </adoe-button>`
}, {
    styles: buttonStyles
})

export default pureLit("adoe-controls", async () => {

    const texts = await fetch("/intl").then(r => r.json())
    return html`
        <adoe-controls-name label="${texts["filter-name"].label}" placeholder="${texts["filter-name"].placeholder}">
            <adoe-tooltip tooltip="${texts["filter-name"].tooltip}">
                <svg xmlns="http://www.w3.org/2000/svg" id="help" width="20px" height="20px" viewBox="0 0 200.000000 200.000000" version="1.0">
                    <path id="path2382" d="m165.33 113.44a103.61 103.61 0 1 1 -207.22 0 103.61 103.61 0 1 1 207.22 0z" transform="matrix(.93739 0 0 .93739 42.143 -6.3392)" stroke-width="0" fill="#fff"/>
                    <g id="layer1">
                        <path id="path2413" d="m100 0c-55.2 0-100 44.8-100 100-5.0495e-15 55.2 44.8 100 100 100s100-44.8 100-100-44.8-100-100-100zm0 12.812c48.13 0 87.19 39.058 87.19 87.188s-39.06 87.19-87.19 87.19-87.188-39.06-87.188-87.19 39.058-87.188 87.188-87.188zm1.47 21.25c-5.45 0.03-10.653 0.737-15.282 2.063-4.699 1.346-9.126 3.484-12.876 6.219-3.238 2.362-6.333 5.391-8.687 8.531-4.159 5.549-6.461 11.651-7.063 18.687-0.04 0.468-0.07 0.868-0.062 0.876 0.016 0.016 21.702 2.687 21.812 2.687 0.053 0 0.113-0.234 0.282-0.937 1.941-8.085 5.486-13.521 10.968-16.813 4.32-2.594 9.808-3.612 15.778-2.969 2.74 0.295 5.21 0.96 7.38 2 2.71 1.301 5.18 3.361 6.94 5.813 1.54 2.156 2.46 4.584 2.75 7.312 0.08 0.759 0.05 2.48-0.03 3.219-0.23 1.826-0.7 3.378-1.5 4.969-0.81 1.597-1.48 2.514-2.76 3.812-2.03 2.077-5.18 4.829-10.78 9.407-3.6 2.944-6.04 5.156-8.12 7.343-4.943 5.179-7.191 9.069-8.564 14.719-0.905 3.72-1.256 7.55-1.156 13.19 0.025 1.4 0.062 2.73 0.062 2.97v0.43h21.598l0.03-2.4c0.03-3.27 0.21-5.37 0.56-7.41 0.57-3.27 1.43-5 3.94-7.81 1.6-1.8 3.7-3.76 6.93-6.47 4.77-3.991 8.11-6.99 11.26-10.125 4.91-4.907 7.46-8.26 9.28-12.187 1.43-3.092 2.22-6.166 2.46-9.532 0.06-0.816 0.07-3.03 0-3.968-0.45-7.043-3.1-13.253-8.15-19.032-0.8-0.909-2.78-2.887-3.72-3.718-4.96-4.394-10.69-7.353-17.56-9.094-4.19-1.062-8.23-1.6-13.35-1.75-0.78-0.023-1.59-0.036-2.37-0.032zm-10.908 103.6v22h21.998v-22h-21.998z"/>
                    </g>
                </svg>
            </adoe-tooltip>
        </adoe-controls-name>
        <adoe-toggle @checked=${(e: CustomEvent) => showInProgress.set(e.detail)}>${texts["filter-progress"]}</adoe-toggle>
        <adoe-controls-reload></adoe-controls-reload>
    `
}, {
    styles
})